			     BASH PATCH REPORT
			     =================

Bash-Release:	4.3
Patch-ID:	bash43-026

Bug-Reported-by:	Tavis Ormandy <taviso@cmpxchg8b.com>
Bug-Reference-ID:
Bug-Reference-URL:	http://twitter.com/taviso/statuses/514887394294652929

Bug-Description:

Under certain circumstances, bash can incorrectly save a lookahead character and
return it on a subsequent call, even when reading a new line.

Index: bash-4.3/parse.y
===================================================================
--- bash-4.3.orig/parse.y	2014-10-07 10:45:26.106820269 -0400
+++ bash-4.3/parse.y	2014-10-07 10:45:48.690819919 -0400
@@ -2953,6 +2953,8 @@
   FREE (word_desc_to_read);
   word_desc_to_read = (WORD_DESC *)NULL;
 
+  eol_ungetc_lookahead = 0;
+
   current_token = '\n';		/* XXX */
   last_read_token = '\n';
   token_to_read = '\n';
Index: bash-4.3/y.tab.c
===================================================================
--- bash-4.3.orig/y.tab.c	2014-10-07 10:45:26.106820269 -0400
+++ bash-4.3/y.tab.c	2014-10-07 10:45:48.694819919 -0400
@@ -5265,6 +5265,8 @@
   FREE (word_desc_to_read);
   word_desc_to_read = (WORD_DESC *)NULL;
 
+  eol_ungetc_lookahead = 0;
+
   current_token = '\n';		/* XXX */
   last_read_token = '\n';
   token_to_read = '\n';
@@ -8537,4 +8539,3 @@
     }
 }
 #endif /* HANDLE_MULTIBYTE */
-
